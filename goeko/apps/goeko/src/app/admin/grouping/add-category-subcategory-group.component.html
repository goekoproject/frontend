<div>
  <button go-button (click)="createNewCategory()">
    {{ 'newCategory' | translate }}
  </button>
</div>

<ul role="list" class="">
  <section>
    <article>
      <goeko-radio-group>
        @for (lang of langs(); track lang.code) {
          <goeko-radio-input [value]="lang.code" [name]="'lang'" [id]="lang.code" (click)="selectedLangSubcategory.set(lang.code)">
            <span class="fi fi-{{ lang.iconFlag }}"></span>
            <p>{{ lang.title | translate }}</p>
          </goeko-radio-input>
        }
      </goeko-radio-group>
    </article>
  </section>
  @defer (when allDataCategories()) {
    @for (category of allDataCategories(); track category.code; let i = $index) {
      <label [for]="category.code" class="ms-2 w-full text-sm font-medium text-gray-900 dark:text-gray-300">
        <li class="flex cursor-pointer justify-between gap-x-6 rounded-md border p-4 py-5">
          <div class="flex w-full flex-col gap-2">
            <h3 class="text-lg font-semibold text-blue-500">
              {{ category.label.translations | labelByCategory: selectedLangSubcategory() }}
            </h3>
            @if (category.open) {
              <ul class="m-1 flex flex-col gap-2">
                @for (subcategory of category.subcategories; track subcategory.id) {
                  <li
                    class="flex items-center gap-2 rounded-lg border px-2 hover:border-2 hover:border-blue-600 has-[:checked]:bg-indigo-50 has-[:checked]:text-indigo-900 has-[:checked]:ring-indigo-200">
                    <input
                      #subcategoryElement
                      type="checkbox"
                      [id]="subcategory.code"
                      [value]="JSON.stringify(subcategory)"
                      (input)="selectedElement()" />

                    <label class="flex h-8 w-full cursor-pointer items-center font-semibold text-blue-500" [for]="subcategory.code">
                      {{ subcategory.label.translations | labelByCategory: selectedLangSubcategory() }}
                    </label>

                    <span class="w-1/3">
                      <p>Last Update</p>
                      {{ subcategory.updateDateTime | date: 'short' }}
                    </span>
                  </li>
                }
              </ul>
            }
          </div>

          <div class="mb-auto flex items-center gap-2">
            <go-toggle-switch (checkedChange)="viewSubcategory($event, category)" />

            <button go-button appearance="white" (click)="addNewSubcategoryToCategory()">
              <i class="ti ti-plus"></i>
              <p class="w-max">{{ 'Add Subcategory' | translate }}</p>
            </button>
          </div>
        </li>
      </label>
    }
  }
</ul>
